<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Batman Riddle Hunt</title>
  <style>
    body {
      background-color: #121212;
      color: #f1f1f1;
      font-family: 'Segoe UI', sans-serif;
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #e1b12c;
    }
    #tagInput {
      display: block;
      margin: 20px auto;
      padding: 10px;
      font-size: 16px;
      border-radius: 8px;
      border: none;
      width: 100%;
      max-width: 300px;
    }
    .tag {
      background-color: #1e1e1e;
      border-radius: 10px;
      padding: 20px;
      margin: 15px 0;
      box-shadow: 0 0 10px rgba(225, 177, 44, 0.3);
    }
    .tag.found {
      border: 2px solid #27ae60;
    }
    .riddle-text {
      font-size: 18px;
      margin-bottom: 10px;
    }
    .guess-input {
      padding: 8px;
      font-size: 16px;
      border-radius: 5px;
      border: none;
      width: 80%;
      margin-right: 10px;
    }
    .check-btn {
      padding: 8px 12px;
      font-size: 14px;
      background-color: #e1b12c;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      color: #121212;
    }
    .check-btn:disabled {
      background-color: #666;
      cursor: not-allowed;
    }
    .feedback {
      margin-top: 10px;
      font-style: italic;
    }
    #congrats {
      margin-top: 30px;
      padding: 15px;
      background-color: #27ae60;
      color: #fff;
      text-align: center;
      border-radius: 8px;
      font-weight: bold;
      display: none;
    }
  </style>
</head>
<body>
  <h1>Batman Riddle Hunt</h1>
  <input type="text" id="tagInput" placeholder="Scan or enter tag..." />

  <div id="tagList"></div>
  <div id="congrats">ðŸŽ‰ You've solved all the riddles! Gotham is safe again! ðŸŽ‰</div>

  <script>
    const RIDDLES = {
      tag1: {
        riddle: "I leave a card wherever I go. My smile is twisted, and I love a good show. Who am I?",
        answer: "Joker"
      },
      tag2: {
        riddle: "I speak in riddles, not just for play. Solve my clues to find your way. Who am I?",
        answer: "Riddler"
      },
      tag3: {
        riddle: "Half my face is scarred by fate, a coin decides each victim's state. Who am I?",
        answer: "Two-Face"
      },
      tag4: {
        riddle: "I freeze what I cannot cure, my heart is cold, my love is pure. Who am I?",
        answer: "Mr. Freeze"
      }
    };

    const STORAGE_RIDDLES = "batmanRiddleProgress";
    const tagInput = document.getElementById("tagInput");
    const tagList = document.getElementById("tagList");
    const congratsDiv = document.getElementById("congrats");

    let foundRiddles = JSON.parse(localStorage.getItem(STORAGE_RIDDLES)) || {};

    function updateFound(tagId) {
      if (!RIDDLES.hasOwnProperty(tagId)) {
        alert("Unknown tag!");
        return;
      }
      if (!foundRiddles[tagId]) {
        foundRiddles[tagId] = { solved: false, userAnswer: "" };
        localStorage.setItem(STORAGE_RIDDLES, JSON.stringify(foundRiddles));
      }
      renderRiddles();
    }

    function updateMessageAndPrize() {
      const total = Object.keys(RIDDLES).length;
      const solved = Object.values(foundRiddles).filter(r => r.solved).length;
      congratsDiv.style.display = solved === total ? "block" : "none";
    }

    function renderRiddles() {
      tagList.innerHTML = "";
      Object.entries(RIDDLES).forEach(([tagId, data]) => {
        const div = document.createElement("div");
        div.className = "tag";

        const isUnlocked = foundRiddles.hasOwnProperty(tagId);

        if (isUnlocked && foundRiddles[tagId].solved) {
          div.classList.add("found");
        }

        if (isUnlocked) {
          const riddleP = document.createElement("p");
          riddleP.className = "riddle-text";
          riddleP.textContent = data.riddle;
          div.appendChild(riddleP);

          const input = document.createElement("input");
          input.type = "text";
          input.className = "guess-input";
          input.placeholder = "Enter your guess";
          input.disabled = foundRiddles[tagId].solved;
          input.value = foundRiddles[tagId].userAnswer || "";

          const feedback = document.createElement("div");
          feedback.className = "feedback";
          feedback.style.color = foundRiddles[tagId].solved ? "#27ae60" : "#f1c40f";
          feedback.textContent = foundRiddles[tagId].solved ? "Correct! ðŸŽ‰" : "";

          const button = document.createElement("button");
          button.className = "check-btn";
          button.textContent = foundRiddles[tagId].solved ? "Solved" : "Check";
          button.disabled = foundRiddles[tagId].solved;

          button.addEventListener("click", () => {
            const guess = input.value.trim().toLowerCase();
            if (!guess) {
              feedback.textContent = "Please enter a guess.";
              feedback.style.color = "#f1c40f";
              return;
            }
            if (guess === data.answer.toLowerCase()) {
              feedback.textContent = "Correct! ðŸŽ‰";
              feedback.style.color = "#27ae60";
              foundRiddles[tagId].solved = true;
              foundRiddles[tagId].userAnswer = input.value.trim();
              input.disabled = true;
              button.disabled = true;
              button.textContent = "Solved";
              div.classList.add("found");
              localStorage.setItem(STORAGE_RIDDLES, JSON.stringify(foundRiddles));
              updateMessageAndPrize();
            } else {
              feedback.textContent = "Incorrect, try again.";
              feedback.style.color = "#e74c3c";
              foundRiddles[tagId].userAnswer = input.value.trim();
              localStorage.setItem(STORAGE_RIDDLES, JSON.stringify(foundRiddles));
            }
          });

          input.addEventListener("input", () => {
            foundRiddles[tagId].userAnswer = input.value;
            localStorage.setItem(STORAGE_RIDDLES, JSON.stringify(foundRiddles));
          });

          div.appendChild(input);
          div.appendChild(button);
          div.appendChild(feedback);
        } else {
          const locked = document.createElement("p");
          locked.textContent = "â“ Riddle hidden";
          locked.style.fontStyle = "italic";
          div.appendChild(locked);
        }

        tagList.appendChild(div);
      });

      updateMessageAndPrize();
    }

    tagInput.addEventListener("change", (e) => {
      const tagId = e.target.value.trim().toLowerCase();
      if (tagId) {
        updateFound(tagId);
        tagInput.value = "";
      }
    });

    renderRiddles();
  </script>
</body>
</html>
